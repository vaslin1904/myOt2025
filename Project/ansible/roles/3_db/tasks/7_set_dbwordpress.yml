---
# - name: БД
#   mysql_db:
#     query: |
#     name: wordpress
#     state: present
#   become: true

- name: ADD BD wordpress
  mysql_query:
    query: |
      CREATE DATABASE IF NOT EXISTS wordpress
      CHARACTER SET utf8mb4
      COLLATE utf8mb4_unicode_ci;
    login_unix_socket: /var/run/mysqld/mysqld.sock
  become: yes

- name: Add wpuser for db wordpress
  mysql_query:
    query: |
      CREATE USER IF NOT EXISTS 'wpuser'@'{{ inventory_hostname }}'
      IDENTIFIED BY '{{ mysql_wp_password }}';
    login_unix_socket: /var/run/mysqld/mysqld.sock
  become: yes

- name: GRAND for  wpuser
  mysql_query:
    query: |
      GRANT ALL PRIVILEGES ON wordpress.* TO 'wpuser'@'%';
    login_unix_socket: /var/run/mysqld/mysqld.sock
  become: yes

- name: Add wpuser for db wordpress
  mysql_query:
    query: "FLUSH PRIVILEGES;"
    login_unix_socket: /var/run/mysqld/mysqld.sock
  become: yes

# - name: Пользователь
#   mysql_user:
#     name: wpuser
#     host: '%'
#     password: "{{ mysql_wp_password }}"
#     priv: 'wordpress.*:ALL'
#     state: present
#   become: true
